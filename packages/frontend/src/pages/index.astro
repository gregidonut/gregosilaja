---
import { Image } from "astro:assets";

import Layout from "@/layouts/Layout.astro";
import Header from "@/components/header/Header.astro";
import Main from "@/components/main/Main.astro";

import type { DialogSet } from "@/utils";
import DynamicDialog from "./dynamicDialog/_DynamicDialogWrapper.tsx";

import ghPic from "@/assets/my_pic.png";
import ghPicSleezy from "@/assets/my_pic_sleezy.png";
import ghPicStartled from "@/assets/my_pic_startled.png";
import ghPicThinking from "@/assets/my_pic_thinking.png";

import frontend from "@/assets/frontend.svg";
import backend from "@/assets/backend.svg";
import devops from "@/assets/devops.svg";
import styles from "./_main.module.css";

const myPics: DialogSet = [
    {
        src: ghPic.src,
        alt: "gh pic base",
        dialog: "",
    },
    {
        src: ghPicStartled.src,
        alt: "gh pic startled",
        dialog: "yikes! someone's here! i gotta think of something cool to say",
    },
    {
        src: ghPicThinking.src,
        alt: "gh pic thinking",
        dialog: "hmmm....",
    },
    {
        src: ghPicSleezy.src,
        alt: "gh pic sleezy",
        dialog: "got it!",
    },
];

const rawFigures = [
    {
        img: frontend,
        cap: "Frontend Polish",
    },
    {
        img: backend,
        cap: "Backend Power",
    },
    {
        img: devops,
        cap: "DevOps Precision",
    },
];

const polFigs = rawFigures.map(function (item) {
    const stArr = item.img.src.split("/");
    const rawAlt = stArr[stArr.length - 1]!.split(".");
    return {
        img: item.img,
        alt: rawAlt[0],
        cap: item.cap,
    };
});
---

<Layout
    description="A personal blog and portfolio showcasing my projects, technical insights, and journey in software development."
>
    <Header />
    <Main>
        <section class={styles.topSection}>
            <DynamicDialog dSet={myPics} client:idle />
            <article>
                <h1>Greg Osilaja</h1>
                <section class={styles.descSec}>
                    {
                        polFigs.map(function (item) {
                            return (
                                <figure>
                                    <Image
                                        height={140}
                                        src={item.img}
                                        alt={item.alt}
                                    />
                                    <figcaption>
                                        <p>
                                            <strong>{item.cap}</strong>
                                        </p>
                                    </figcaption>
                                </figure>
                            );
                        })
                    }
                </section>
            </article>
        </section>
        <section class={styles.ghCharts}>
            <div class={styles.ghContribs}>
                <img
                    src="https://ghchart.rshah.org/gregidonut"
                    alt="gregidonut gh chart"
                    loading="lazy"
                    decoding="async"
                />
            </div>
            <img
                src="https://github-readme-stats.vercel.app/api/top-langs/?username=gregidonut&layout=donut&show_icons=true&theme=dark"
                alt="most used langs chart"
                loading="lazy"
                decoding="async"
            />
        </section>
    </Main>
</Layout>
